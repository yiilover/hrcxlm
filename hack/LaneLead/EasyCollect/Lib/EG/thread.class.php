<?php
class thread { public $hooks = array(); public $args = array(); function __construct() { } function addthread($func) { $args = array_slice(func_get_args(), 1); $this -> hooks[] = $func; $this -> args[] = $args; return true; } function runthread() { $cms_admin_cookie = F('cms_admin_cookie'); if (isset($_GET['flag'])) { $flag = intval($_GET['flag']); } if ($flag || $flag === 0) { call_user_func_array($this -> hooks[$flag], $this -> args[$flag]); } else { for($i = 0, $size = count($this -> hooks); $i < $size; $i++) { $outurl = __ACTION__ . '/flag/' . $i; _remoteTask($outurl); } } } function __destruct() { } } ?>